<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
        <title>IChange</title>
        
        <!-- some fancy styles-->
        <style>
        .btn {
            background-color: #990066; /* purple */
            }
        </style>
        
        
        <!-- navigation page -->
        <link rel="stylesheet" type="text/css" href="css/menu.css"/>
        <style>
            
            .navigation{
                
                visibility: hidden;
                height: 100%;
                width: 100%;
                margin: 0;
                padding: 0;
                float: left;
                position: fixed; 
                top: 0; bottom: 0; left: 0; 
            }
            #nav_btn{
                 top: 0%;
                 position: fixed;
                 height: 50px;
                 width: 40px;
                
            }
        
        </style>
        
        <!-- hypnosis image -->
         <style>
       .hypnosis{
           width: 100%;
           height: 100%;
           top: 25%;
           left: 15%
           right: 15%;
           text-align: center;
           position: fixed;
           
       }
        
        .blue{
            /*define the origin of the rotation*/             
            transform-origin: center 60%;               
                  
                 
                 
             }
        </style>
        
        
        <!-- progress bar -->
        <link rel="stylesheet" type="text/css" href="css/progress_bar.css"/>
        
        <!--javascript to control a navigation page-->
        
        
        <script>
            
            function open_nav(){                 
                
               document.getElementsByClassName("navigation")[0].style.visibility = "visible";
            }        
            
            function close_nav(){
                document.getElementsByClassName("navigation")[0].style.visibility = "hidden";
            }
        
        </script> 
        
        <!-- Javascript to rotate the hypnosis image -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
        <script src="http://beneposto.pl/jqueryrotate/js/jQueryRotateCompressed.js"></script>
        <script src="js/rotation.js"></script>
        
        <script>
            
            //progress of the user
            function loadProgress(status) {
                        var xhttp = new XMLHttpRequest();
                        xhttp.onreadystatechange = function() {
                            if (xhttp.readyState == 4 && xhttp.status == 200) {
                                document.getElementsByClassName('progress_text')[0].innerHTML = xhttp.responseText;
                                
                                if(status == 0){
                                alert("Click on the image to start the hypnosis. We will tell you when to stop.");
                                }
                
                                }
                            };
                        xhttp.open("GET", "php/progress.php?q=" +status, true);
                        xhttp.send();
                        }
                                    
            
            
            
            $(document).ready(function() {              
                                             
               loadProgress(0);
               
               var rotation = 0;
                $('.blue').click(function(){
                    //change the phase of the rotation --> stop or start
                    
                    
                    
                   
                    
                    
                    rotation = 1 - rotation;
                    if (rotation){
                        
                        $(this).rotate({ startDeg:0, count:2, duration:80, forceJS:true });
                        document.getElementById('music').play();
                        
                        
                        
                        }
                    
                    else{
                        
                        $(this).stop();
                        document.getElementById('music').pause();
                    }
                    
                    
                   
                    
                    }); 
                
                var seconds = 0;
                var timerId = setInterval(function() {
                    if(rotation){
                        seconds += 1;
                        console.log(seconds);
                    }  
                    
                    if(seconds == 172){
                        
                        loadProgress(1);
                        alert("Well done! Today you are one step closer to success! We are waiting for you tomorrow!")                        
                        seconds = 0;
                        
                    }
                    
                }, 1000);
                
            }); 
            
            
            
            
        </script>
       
        
    </head>
    <body>
         
        <script type="text/javascript" src="cordova.js"></script>    
        
            
        <!--table for making-->
        <table style="height:100%; bordercolor=black; width=100% ; background-color=purple;
        position: absolute; top: 0; bottom: 0; left: 0; right: 0;">
            
        <!--upper row-->
        <tr  style="background-color:#990066; height: 15%; width=100%">
        <td> 
              <!-- dashed button -->
            <center>
            <button class="btn" onclick="open_nav()">
            <img src="dash_button.svg" width=40 height=55 alt="">
            </button>
            </center>        
            
        </td>  
            
        <td width=100%>
            <!--headline-->
            <center>                
            <font style ="color: rgba(0,0,0,0.6); text-shadow: 2px 2px 3px rgba(255,255,255,0.1);" size="+5" face="times"><b>ICHANGE</b></font>    
            </center>
        </td>
        </tr>
            
        <!--bottom row-->
        <tr  style="height: 75%; width=100%">
            <td colspan = 2 >
            <!--hypnosis image -->
                
            <div class = "hypnosis">               
            <!-- blue hypnosis image -->
            <img class = "blue" src = "images/blue.png" height = 50% width=60% >
            
             <br><br>
    
            <p class = "progress_text"></p>
            </div>
              
            <!-- Hypnosis music -->
            <audio id="music" src="music/buddah_music.mp3" preload="auto"></audio>
                
            </td>
        </tr>          
            
        </table>
        
         <div class="navigation">
                
            <ul>
            <!-- <li><a href="sign_in.html">Sign In</a></li> -->
            <li><a href="about_us.html">About Us</a></li>
            <li><a class="active" href="index.html">Hypnosis</a></li>
                <div align="right"><button id="nav_btn" onclick="close_nav()" > X </button></div>
            </ul>
            </div>
           
    </body>
</html>